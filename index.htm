<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EKUSFM by ESTACIONKUSMEDIOS</title>
  <meta name="theme-color" content="#1e293b">
  <link rel="icon" type="image/png" href="icon.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { font-family: 'Poppins', sans-serif; margin:0; background:#0f172a; color:#fff;}
    .overlay { position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:100;display:none;background:rgba(30,41,59,0.7);}
    .overlay.active { display:block;}
    .header {display:flex;align-items:center;justify-content:space-between;padding:12px 22px 4px 22px;}
    .logo {font-size:1.8rem;font-weight:bold;}
    .menu-btn { background:none;border:none;font-size:1.7rem;color:#fff;cursor:pointer;}
    .main-content { position:relative; max-width:370px; margin:30px auto 0 auto; padding:22px 15px; background:#1e293b;border-radius:18px;box-shadow:0 2px 12px #0003; overflow:hidden;}
    .status-badge { background:#334155;padding:7px 12px;border-radius:7px;margin-bottom:13px;display:flex;align-items:center;gap:10px;}
    .status-badge i { color:#38bdf8;}
    #live-announcer-btn { margin:10px 0 5px 0; display:none; background: #ff1744; color:#fff; border:none; border-radius:8px; padding:8px 16px; font-size:1.08rem; font-weight:bold; cursor:pointer; box-shadow:0 2px 8px #0005;}
    #live-announcer-btn i { margin-right:7px;}
    .cover-container { display:flex;justify-content:center;margin-bottom:13px;}
    .cover-img { width:160px;height:160px;border-radius:15px;box-shadow:0 3px 16px #0008;object-fit:cover;}
    .song-info { text-align:center;margin-bottom:8px;}
    .song-title { font-size:1.18rem;font-weight:bold;}
    .artist-name { color:#38bdf8;font-size:1.01rem;}
    .now-playing {color:#94a3b8;font-size:.99em;}
    .controls { display:flex;justify-content:center;gap:16px;margin:13px 0;}
    .control-btn, .play-btn { background:#334155;border:none;color:#fff;font-size:1.25rem;padding:10px 19px;border-radius:8px;cursor:pointer;}
    .play-btn { background:#22d3ee;color:#222;font-size:1.36rem;}
    .volume-container { display:flex;align-items:center;gap:10px;margin-top:7px;}
    .volume-icon i { font-size:1.1rem;}
    .volume-control { width:100px;}
    .service-btns { display:flex;gap:8px;margin:13px 0 0 0;justify-content:center;}
    .service-btn { background:#222d;color:#fff;padding:6px 13px;border:none;border-radius:7px;cursor:pointer;font-size:.97rem;}
    .service-btn.spotify { background:#1db954;}
    .service-btn.apple { background:#333;}
    .social-buttons { display:flex;gap:13px;margin:20px 0 0 0;justify-content:center;}
    .social-buttons a { color:#fff;font-size:1.4rem;transition:.2s;}
    .social-buttons a:hover { color:#0ff;}
    .radio-clock-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 11px;
      margin: 16px 0 8px 0;
      font-size: 1.07rem;
      background: #222d;
      border-radius: 8px;
      padding: 7px 15px;
      color: #fff;
    }
    .radio-clock-container i {
      color: #facc15;
      font-size: 1.5em;
    }
    .watermark {position:fixed;right:10px;bottom:8px;font-size:.93rem;color:#64748b;}
    #fixBtn {position:fixed;left:10px;bottom:10px;background:#facc15;color:#222;border:none;border-radius:50%;font-size:1.22rem;width:42px;height:42px;cursor:pointer;box-shadow:0 2px 12px #0005;}
    #fixAlert { position:fixed;left:50%;bottom:62px;transform:translateX(-50%);background:#222d;color:#fff;padding:10px 22px;border-radius:8px;display:none; }
    .offline-alert { position:fixed;top:0;left:0;width:100vw;background:#f87171;color:#fff;padding:8px;text-align:center;display:none;z-index:300;}
    .menu { position:fixed;top:0;left:0;height:100vh;width:320px;max-width:94vw;background:#1e293b;box-shadow:1px 0 9px #0008;z-index:150;transform:translateX(-100%);transition:.2s;display:flex;flex-direction:column; }
    .menu.open { transform:translateX(0);}
    .menu-header { display:flex;align-items:center;justify-content:space-between;padding:15px 22px 6px 22px;}
    .menu-title { font-size:1.3rem;font-weight:bold;}
    .close-menu { background:none;border:none;font-size:1.5rem;color:#fff;cursor:pointer;}
    .menu-section {margin:0 0 23px 0;}
    .menu-section-title {margin:8px 22px 5px 22px;font-size:1.02rem;color:#38bdf8;}
    .menu-links { list-style:none;padding:0 22px;margin:0;}
    .menu-links li {margin:11px 0;}
    .menu-link { color:#fff;text-decoration:none;font-size:1.06rem;transition:.2s;}
    .menu-link i {margin-right:9px;}
    .menu-link:hover { color:#38bdf8;}
    #menu-social-links li { display:flex;align-items:center;gap:10px;}
    #menu-status {display:flex;align-items:center;gap:12px;margin:18px 22px 0 22px;font-size:1.08rem;}
    #menu-status-icon {font-size:1.2em;}
    .modal { display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.7);z-index:250;align-items:center;justify-content:center;}
    .modal-content {background:#1e293b;padding:25px 18px 18px 18px;border-radius:15px;max-width:370px;width:94vw;box-shadow:0 2px 19px #000a;position:relative;}
    .modal-title {font-size:1.08rem;font-weight:bold;margin-bottom:13px;}
    .modal-close {position:absolute;top:11px;right:13px;font-size:1.5rem;background:none;border:none;color:#fff;cursor:pointer;}
    .about-logo {width:70px;height:70px;border-radius:14px;margin-bottom:8px;object-fit:cover;}
    .share-option {display:flex;align-items:center;gap:12px;margin-bottom:12px;cursor:pointer;}
    .share-icon {width:38px;height:38px;display:flex;align-items:center;justify-content:center;font-size:1.6rem;border-radius:50%;}
    .share-url-container {display:flex;gap:5px;margin-top:7px;}
    .share-url {flex:1;background:#222d;color:#fff;padding:7px 10px;border-radius:6px;border:none;}
    .copy-btn {background:#38bdf8;color:#222;border:none;border-radius:6px;padding:7px 15px;cursor:pointer;}
    #customizeBtn {position:fixed;bottom:60px;right:12px;z-index:300;font-size:1.5em;background:#38bdf8;color:#222;border-radius:50%;border:none;padding:12px 16px;box-shadow:0 2px 10px #0006;}
    #customizePanel {display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:400;background:rgba(0,0,0,0.7);align-items:center;justify-content:center;}
    #customizePanel .panelbox {background:#fff;color:#222;padding:26px 24px;border-radius:22px;max-width:330px;width:95vw;position:relative;}
    #customizePanel h2 {font-size:1.25em;}
    #stickerCatalog {display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:410;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;}
    #stickerCatalog .panelbox {background:#fff;padding:14px;border-radius:12px;max-width:260px;}
    #stickerCatalog .sticker-option {cursor:pointer;}
    #customStickersArea {position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:50;}
    @keyframes confetti {0%{filter:hue-rotate(0);}100%{filter:hue-rotate(360deg);}}
    @keyframes wave {0%{filter:brightness(1);}50%{filter:brightness(1.2);}100%{filter:brightness(1);}}
    /* Basta de Bullying Modal */
    #modalBasta {display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.85);align-items:center;justify-content:center;}
    #modalBasta .panelbox {background:#fff;color:#222;padding:23px 18px 18px 18px;border-radius:18px;max-width:360px;width:90vw;position:relative;}
    #modalBasta .modal-close {position:absolute;top:12px;right:13px;font-size:1.4em;border:none;background:none;color:#222;cursor:pointer;}
    #modalBasta h2 {font-size:1.18em;margin-bottom:10px;}
    #modalBasta p {margin-bottom:15px;font-size:1em;}
    #modalBasta ul {margin:0 0 10px 0;padding-left:17px;}
    #modalBasta li {margin-bottom:7px;}
    #modalBasta .basta-btn {background:#38bdf8;color:#222;font-weight:bold;padding:9px 19px;border:none;border-radius:9px;font-size:1.09em;cursor:pointer;}
  </style>
</head>
<body>
  <div class="overlay"></div>
  <div class="header">
    <div class="logo" id="radio-name">EKUSFM</div>
    <button class="menu-btn" id="menuBtn"><i class="fas fa-bars"></i></button>
  </div>
  <div class="main-content">
    <div id="customStickersArea"></div>
    <div class="status-badge" id="status-badge">
      <i class="fas fa-broadcast-tower"></i>
      <span id="status-text">Transmitiendo en vivo desde nuestra cabina central üéôÔ∏è en digital</span>
    </div>
    <button id="live-announcer-btn"><i class="fas fa-microphone"></i> Locutor en vivo</button>
    <div class="cover-container">
      <img src="/placeholder.svg" alt="Album Cover" class="cover-img" id="cover-img">
    </div>
    <div class="song-info">
      <div class="song-title" id="song-title">Cargando...</div>
      <div class="artist-name" id="artist-name">Espere un momento</div>
      <div class="now-playing" id="now-playing-text">Actualmente escuchas üé∂</div>
    </div>
    <div class="controls">
      <button class="control-btn" id="prevBtn" disabled><i class="fas fa-step-backward"></i></button>
      <button class="play-btn" id="playPauseBtn"><i class="fas fa-play"></i></button>
      <button class="control-btn" id="nextBtn" disabled><i class="fas fa-step-forward"></i></button>
    </div>
    <div class="volume-container">
      <div class="volume-icon"><i class="fas fa-volume-up" id="volumeIcon"></i></div>
      <input type="range" class="volume-control" id="volumeControl" min="0" max="1" step="0.01" value="1">
    </div>
    <div class="service-btns" id="service-btns"></div>
    <div class="status-indicator" id="statusIndicator"></div>
    <div class="social-buttons" id="social-buttons"></div>
    <div class="radio-clock-container">
      <i class="fas fa-clock"></i>
      <div>
        <div id="radio-clock-date" style="font-weight:bold;"></div>
        <div>
          <span id="radio-clock">00:00:00</span>
          <span style="font-size:0.91em;color:#38bdf8;">Hora M√©xico</span>
        </div>
        <div style="font-size:0.93em;color:#38bdf8;">Hora oficial de la radio</div>
      </div>
    </div>
  </div>
  <button id="customizeBtn" title="Personaliza tu radio üé®">üé®</button>
  <div id="customizePanel">
    <div class="panelbox">
      <button onclick="document.getElementById('customizePanel').style.display='none'" style="position:absolute;top:9px;right:10px;border:none;background:none;font-size:1.5em;">&times;</button>
      <h2>Personaliza tu radio</h2>
      <label>Color de fondo: <input type="color" id="bgColorPicker"></label><br><br>
      <label>Animaci√≥n:
        <select id="animationSelect">
          <option value="">Ninguna</option>
          <option value="confetti">Confetti</option>
          <option value="wave">Onda</option>
        </select>
      </label><br><br>
      <label>Stickers:
        <button id="addStickerBtn">Agregar üéâ</button>
      </label>
      <button id="resetCustomizationBtn" style="margin-top:14px;background:#f87171;color:#fff;padding:8px 14px;border:none;border-radius:8px;cursor:pointer;">Restaurar original</button>
    </div>
  </div>
  <div id="stickerCatalog">
    <div class="panelbox">
      <h3>Elige un sticker</h3>
      <div style="display:flex;gap:7px;flex-wrap:wrap;">
        <img src="https://em-content.zobj.net/source/microsoft-teams/337/party-popper_1f389.png" class="sticker-option" width="38">
        <img src="https://em-content.zobj.net/source/microsoft-teams/337/fire_1f525.png" class="sticker-option" width="38">
        <img src="https://em-content.zobj.net/source/microsoft-teams/337/sparkles_2728.png" class="sticker-option" width="38">
        <img src="https://em-content.zobj.net/source/microsoft-teams/337/radio_1f4fb.png" class="sticker-option" width="38">
        <img src="https://em-content.zobj.net/source/microsoft-teams/337/headphone_1f3a7.png" class="sticker-option" width="38">
        <img src="https://em-content.zobj.net/source/microsoft-teams/337/heart-on-fire_2764-fe0f-200d-1f525.png" class="sticker-option" width="38">
      </div>
    </div>
  </div>
  <div class="menu" id="menu">
    <div class="menu-header">
      <div class="menu-title" id="menu-title">Men√∫</div>
      <button class="close-menu" id="close-menu"><i class="fas fa-times"></i></button>
    </div>
    <div class="menu-section">
      <h3 class="menu-section-title">Opciones</h3>
      <ul class="menu-links">
        <li><a href="#" class="menu-link" id="historyLink"><i class="fas fa-history"></i> Historial de canciones</a></li>
        <li><a href="#" class="menu-link" id="aboutLink"><i class="fas fa-info-circle"></i> Acerca de</a></li>
        <li><a href="#" class="menu-link" id="shareLink"><i class="fas fa-share-alt"></i> Compartir</a></li>
        <li><a href="novedades.htm" class="menu-link"><i class="fas fa-newspaper"></i> Novedades</a></li>
      </ul>
    </div>
    <div class="menu-section">
      <h3 class="menu-section-title">Basta de Bullying</h3>
      <ul class="menu-links">
        <li>
          <a href="#" class="menu-link" id="bastaBullyingLink"><i class="fas fa-hand-paper"></i> Firma el pacto</a>
        </li>
      </ul>
    </div>
    <div class="menu-section">
      <h3 class="menu-section-title">Redes Sociales</h3>
      <ul class="menu-links" id="menu-social-links"></ul>
      <div id="menu-status">
        <i id="menu-status-icon" class="fas fa-circle" style="color:limegreen;"></i>
        <span id="menu-status-text">Transmisi√≥n Online</span>
      </div>
    </div>
    <div class="menu-section" id="menu-stats-section">
      <h3 class="menu-section-title">Estad√≠sticas</h3>
      <ul class="menu-links" id="menu-stats">
        <li><span><i class="fas fa-users"></i> Oyentes ahora: <b id="stat-listeners">-</b></span></li>
        <li><span><i class="fas fa-music"></i> Canciones hoy: <b id="stat-today">-</b></span></li>
        <li><span><i class="fas fa-history"></i> Historial total: <b id="stat-history">-</b></span></li>
        <li><span><i class="fas fa-clock"></i> Uptime: <b id="stat-uptime">-</b></span></li>
      </ul>
    </div>
  </div>
  <div class="modal" id="historyModal">
    <div class="modal-content">
      <button class="modal-close" id="closeHistoryModal">&times;</button>
      <h3 class="modal-title">Historial de canciones</h3>
      <div id="historyModalContent" style="margin-bottom:10px;">Cargando historial...</div>
    </div>
  </div>
  <div class="modal" id="aboutModal">
    <div class="modal-content">
      <button class="modal-close" id="closeAboutModal">&times;</button>
      <h3 class="modal-title">Acerca de</h3>
      <div class="about-content">
        <img id="aboutLogo" class="about-logo" src="/placeholder.svg" alt="Logo">
        <p class="about-text" id="aboutDescription">Cargando...</p>
        <p class="about-text">Versi√≥n: 1.0.0</p>
        <p class="about-text">Desarrollado con ‚ù§Ô∏è por <span id="aboutDeveloper">ESTACIONKUSMEDIOS</span></p>
        <p class="about-text">Powered by: <strong>ESTACIONKUSMEDIOS</strong></p>
      </div>
    </div>
  </div>
  <div class="modal" id="shareModal">
    <div class="modal-content">
      <button class="modal-close" id="closeShareModal">&times;</button>
      <h3 class="modal-title">Compartir</h3>
      <div id="shareOptions">
        <div class="share-option" id="shareWhatsapp">
          <div class="share-icon" style="background-color: #25D366;"><i class="fab fa-whatsapp"></i></div>
          <div class="share-text">Compartir en WhatsApp</div>
        </div>
        <div class="share-option" id="shareFacebook">
          <div class="share-icon" style="background-color: #1877F2;"><i class="fab fa-facebook-f"></i></div>
          <div class="share-text">Compartir en Facebook</div>
        </div>
        <div class="share-option" id="shareTwitter">
          <div class="share-icon" style="background-color: #1DA1F2;"><i class="fab fa-twitter"></i></div>
          <div class="share-text">Compartir en Twitter</div>
        </div>
        <div class="share-url-container">
          <input type="text" id="shareUrl" class="share-url" readonly>
          <button id="copyLink" class="copy-btn">Copiar</button>
        </div>
      </div>
    </div>
  </div>
  <div id="modalBasta">
    <div class="panelbox">
      <button class="modal-close" id="closeBastaModal">&times;</button>
      <h2>Firma el Pacto: Basta de Bullying</h2>
      <p>¬°√önete y haz la diferencia! El bullying es un problema real que debemos erradicar. No te quedes callado. Firma el pacto y s√© parte de la soluci√≥n.</p>
      <ul>
        <li>No te quedes callado si eres testigo.</li>
        <li>Apoya a las personas que lo sufren.</li>
        <li>Habla con un adulto de confianza.</li>
        <li>Denuncia cualquier caso.</li>
      </ul>
      <p><b>FAQ:</b><br>
      <b>¬øQu√© debo hacer?</b><br>
      - Si ves bullying, informa de inmediato.<br>
      - Apoya a la persona afectada.<br>
      - No seas c√≥mplice ni espectador.<br>
      - Recuerda: ¬°Tu voz cuenta!</p>
      <button class="basta-btn" onclick="window.open('https://estacionkusmedios.org','_blank')">Firma el pacto</button>
    </div>
  </div>
  <div class="offline-alert" id="offlineAlert">Sin conexi√≥n a internet. Algunas funciones pueden no estar disponibles.</div>
  <div class="watermark">Powered by: ESTACIONKUSMEDIOS</div>
  <audio id="audio" preload="auto"></audio>
  <button id="fixBtn" title="Solucionar problemas"><i class="fas fa-wrench"></i></button>
  <div id="fixAlert"></div>
  <script src="script.js"></script>
  <script>
  function updateRadioClock() {
    const now = new Date();
    const mexicoTime = now.toLocaleTimeString('es-MX', {
      timeZone: 'America/Mexico_City',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit'
    });
    const mexicoDate = now.toLocaleDateString('es-MX', {
      timeZone: 'America/Mexico_City',
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
    document.getElementById('radio-clock-date').textContent =
      mexicoDate.charAt(0).toUpperCase() + mexicoDate.slice(1);
    document.getElementById('radio-clock').textContent = mexicoTime;
  }
  setInterval(updateRadioClock, 1000);
  updateRadioClock();

  document.getElementById('customizeBtn').onclick = () => {
    document.getElementById('customizePanel').style.display = 'flex';
  };
  const bgPicker = document.getElementById('bgColorPicker');
  bgPicker.value = localStorage.getItem('radioBgColor') || '#1e293b';
  bgPicker.oninput = () => {
    document.body.style.background = bgPicker.value;
    localStorage.setItem('radioBgColor', bgPicker.value);
  };
  document.body.style.background = bgPicker.value;
  const animationSelect = document.getElementById('animationSelect');
  animationSelect.value = localStorage.getItem('radioAnimation') || '';
  animationSelect.oninput = () => {
    localStorage.setItem('radioAnimation', animationSelect.value);
    applyAnimation(animationSelect.value);
  };
  function applyAnimation(anim) {
    document.body.style.animation = '';
    if(anim === 'confetti') document.body.style.animation = 'confetti 1.5s infinite linear';
    else if(anim === 'wave') document.body.style.animation = 'wave 1.2s infinite alternate';
  }
  applyAnimation(animationSelect.value);
  document.getElementById('addStickerBtn').onclick = () => {
    document.getElementById('stickerCatalog').style.display = 'flex';
  };
  document.querySelectorAll('.sticker-option').forEach(img => {
    img.onclick = () => {
      const sticker = img.cloneNode();
      sticker.style.position = 'absolute';
      sticker.style.left = (10 + Math.random() * 70) + '%';
      sticker.style.top = (10 + Math.random() * 60) + '%';
      sticker.style.pointerEvents = 'none';
      document.getElementById('customStickersArea').appendChild(sticker);
      let stickers = JSON.parse(localStorage.getItem('radioStickers') || 